<!DOCTYPE html>
<html>
<head lang="zh-TW">
    <meta charset="UTF-8">
    <title>js selection example</title>
    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
    <style>
        .test-area {
            height: 400px;
            width: 100%;
        }
    </style>
</head>
<body>
<form name="testForm">
    <div contenteditable="true" class="test-area" name="testArea" id="testArea">
        <img src="http://user.mgmt.pixnet/~nobita/js-selection-example/image/0001.png" width="100">
        aaa
        <img src="http://user.mgmt.pixnet/~nobita/js-selection-example/image/0001.png" width="100">
        aaa
        <img src="http://user.mgmt.pixnet/~nobita/js-selection-example/image/0001.png" width="100">
        aaa
        <img src="http://user.mgmt.pixnet/~nobita/js-selection-example/image/0001.png" width="100">
        aaa
    </div>
    <button type="button" id="setBold">bold</button>
    <p>
        select text: <span id="selectText"></span><br/>
        selectStart: <span id="selectStart"></span><br/>
        selectEnd:   <span id="selectEnd"></span><br/>
    </p>
    <p>
        textarea content html : <span id="sourceCode"></span>
    </p>

    <hr/>
    <p>
        其他直接設定字串樣式的 native method : <a href="http://www.w3school.com.cn/tiy/t.asp?f=jseg_str_style">http://www.w3school.com.cn/tiy/t.asp?f=jseg_str_style</a>
    </p>
</form>
<script>
    $(function() {
        var info = {};

        var setActiveToInfo = function() {
            var range = document.createRange();
            var selection = window.getSelection();
            var startNode = selection.anchorNode.anchorNode;

            console.clear();
            console.log(selection);
            console.log(selection.getRangeAt(0));
        };

        $(window).on({
            keyup: setActiveToInfo,
            mouseup: setActiveToInfo
        });

        $('#setBold').click(function() {
            var allText = $('#testArea')[0].value,
                newText,
                tmpArr = [];

            tmpArr.push(allText.substr(0, info.selectionStart));
            tmpArr.push(allText.substr(info.selectionStart, info.selectionEnd));
            tmpArr.push(allText.substr(info.selectionStart));
            console.log(tmpArr);

//            $('#testArea').html()
        });
    });
</script>
</body>
</html>

